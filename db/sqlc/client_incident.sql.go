// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.27.0
// source: client_incident.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createIncident = `-- name: CreateIncident :one
INSERT INTO incident (
    employee_id,
    location_id,
    reporter_involvement,
    inform_who,
    incident_date,
    runtime_incident,
    incident_type,
    passing_away,
    self_harm,
    violence,
    fire_water_damage,
    accident,
    client_absence,
    medicines,
    organization,
    use_prohibited_substances,
    other_notifications,
    severity_of_incident,
    incident_explanation,
    recurrence_risk,
    incident_prevent_steps,
    incident_taken_measures,
    technical,
    organizational,
    mese_worker,
    client_options,
    other_cause,
    cause_explanation,
    physical_injury,
    physical_injury_desc,
    psychological_damage,
    psychological_damage_desc,
    needed_consultation,
    succession,
    succession_desc,
    other,
    other_desc,
    additional_appointments,
    employee_absenteeism,
    client_id
) VALUES (
    $1, $2, $3, $4, $5, $6, $7, $8, $9, $10,
    $11, $12, $13, $14, $15, $16, $17, $18, $19, $20,
    $21, $22, $23, $24, $25, $26, $27, $28, $29, $30,
    $31, $32, $33, $34, $35, $36, $37, $38, $39, $40
) RETURNING id, employee_id, location_id, reporter_involvement, inform_who, incident_date, runtime_incident, incident_type, passing_away, self_harm, violence, fire_water_damage, accident, client_absence, medicines, organization, use_prohibited_substances, other_notifications, severity_of_incident, incident_explanation, recurrence_risk, incident_prevent_steps, incident_taken_measures, technical, organizational, mese_worker, client_options, other_cause, cause_explanation, physical_injury, physical_injury_desc, psychological_damage, psychological_damage_desc, needed_consultation, succession, succession_desc, other, other_desc, additional_appointments, employee_absenteeism, client_id, soft_delete, updated_at, created_at
`

type CreateIncidentParams struct {
	EmployeeID              int64       `json:"employee_id"`
	LocationID              *int64      `json:"location_id"`
	ReporterInvolvement     string      `json:"reporter_involvement"`
	InformWho               []byte      `json:"inform_who"`
	IncidentDate            pgtype.Date `json:"incident_date"`
	RuntimeIncident         string      `json:"runtime_incident"`
	IncidentType            string      `json:"incident_type"`
	PassingAway             bool        `json:"passing_away"`
	SelfHarm                bool        `json:"self_harm"`
	Violence                bool        `json:"violence"`
	FireWaterDamage         bool        `json:"fire_water_damage"`
	Accident                bool        `json:"accident"`
	ClientAbsence           bool        `json:"client_absence"`
	Medicines               bool        `json:"medicines"`
	Organization            bool        `json:"organization"`
	UseProhibitedSubstances bool        `json:"use_prohibited_substances"`
	OtherNotifications      bool        `json:"other_notifications"`
	SeverityOfIncident      string      `json:"severity_of_incident"`
	IncidentExplanation     *string     `json:"incident_explanation"`
	RecurrenceRisk          string      `json:"recurrence_risk"`
	IncidentPreventSteps    *string     `json:"incident_prevent_steps"`
	IncidentTakenMeasures   *string     `json:"incident_taken_measures"`
	Technical               []byte      `json:"technical"`
	Organizational          []byte      `json:"organizational"`
	MeseWorker              []byte      `json:"mese_worker"`
	ClientOptions           []byte      `json:"client_options"`
	OtherCause              *string     `json:"other_cause"`
	CauseExplanation        *string     `json:"cause_explanation"`
	PhysicalInjury          string      `json:"physical_injury"`
	PhysicalInjuryDesc      *string     `json:"physical_injury_desc"`
	PsychologicalDamage     string      `json:"psychological_damage"`
	PsychologicalDamageDesc *string     `json:"psychological_damage_desc"`
	NeededConsultation      string      `json:"needed_consultation"`
	Succession              []byte      `json:"succession"`
	SuccessionDesc          *string     `json:"succession_desc"`
	Other                   bool        `json:"other"`
	OtherDesc               *string     `json:"other_desc"`
	AdditionalAppointments  *string     `json:"additional_appointments"`
	EmployeeAbsenteeism     []byte      `json:"employee_absenteeism"`
	ClientID                int64       `json:"client_id"`
}

func (q *Queries) CreateIncident(ctx context.Context, arg CreateIncidentParams) (Incident, error) {
	row := q.db.QueryRow(ctx, createIncident,
		arg.EmployeeID,
		arg.LocationID,
		arg.ReporterInvolvement,
		arg.InformWho,
		arg.IncidentDate,
		arg.RuntimeIncident,
		arg.IncidentType,
		arg.PassingAway,
		arg.SelfHarm,
		arg.Violence,
		arg.FireWaterDamage,
		arg.Accident,
		arg.ClientAbsence,
		arg.Medicines,
		arg.Organization,
		arg.UseProhibitedSubstances,
		arg.OtherNotifications,
		arg.SeverityOfIncident,
		arg.IncidentExplanation,
		arg.RecurrenceRisk,
		arg.IncidentPreventSteps,
		arg.IncidentTakenMeasures,
		arg.Technical,
		arg.Organizational,
		arg.MeseWorker,
		arg.ClientOptions,
		arg.OtherCause,
		arg.CauseExplanation,
		arg.PhysicalInjury,
		arg.PhysicalInjuryDesc,
		arg.PsychologicalDamage,
		arg.PsychologicalDamageDesc,
		arg.NeededConsultation,
		arg.Succession,
		arg.SuccessionDesc,
		arg.Other,
		arg.OtherDesc,
		arg.AdditionalAppointments,
		arg.EmployeeAbsenteeism,
		arg.ClientID,
	)
	var i Incident
	err := row.Scan(
		&i.ID,
		&i.EmployeeID,
		&i.LocationID,
		&i.ReporterInvolvement,
		&i.InformWho,
		&i.IncidentDate,
		&i.RuntimeIncident,
		&i.IncidentType,
		&i.PassingAway,
		&i.SelfHarm,
		&i.Violence,
		&i.FireWaterDamage,
		&i.Accident,
		&i.ClientAbsence,
		&i.Medicines,
		&i.Organization,
		&i.UseProhibitedSubstances,
		&i.OtherNotifications,
		&i.SeverityOfIncident,
		&i.IncidentExplanation,
		&i.RecurrenceRisk,
		&i.IncidentPreventSteps,
		&i.IncidentTakenMeasures,
		&i.Technical,
		&i.Organizational,
		&i.MeseWorker,
		&i.ClientOptions,
		&i.OtherCause,
		&i.CauseExplanation,
		&i.PhysicalInjury,
		&i.PhysicalInjuryDesc,
		&i.PsychologicalDamage,
		&i.PsychologicalDamageDesc,
		&i.NeededConsultation,
		&i.Succession,
		&i.SuccessionDesc,
		&i.Other,
		&i.OtherDesc,
		&i.AdditionalAppointments,
		&i.EmployeeAbsenteeism,
		&i.ClientID,
		&i.SoftDelete,
		&i.UpdatedAt,
		&i.CreatedAt,
	)
	return i, err
}

const listIncidents = `-- name: ListIncidents :many
SELECT 
    i.id, i.employee_id, i.location_id, i.reporter_involvement, i.inform_who, i.incident_date, i.runtime_incident, i.incident_type, i.passing_away, i.self_harm, i.violence, i.fire_water_damage, i.accident, i.client_absence, i.medicines, i.organization, i.use_prohibited_substances, i.other_notifications, i.severity_of_incident, i.incident_explanation, i.recurrence_risk, i.incident_prevent_steps, i.incident_taken_measures, i.technical, i.organizational, i.mese_worker, i.client_options, i.other_cause, i.cause_explanation, i.physical_injury, i.physical_injury_desc, i.psychological_damage, i.psychological_damage_desc, i.needed_consultation, i.succession, i.succession_desc, i.other, i.other_desc, i.additional_appointments, i.employee_absenteeism, i.client_id, i.soft_delete, i.updated_at, i.created_at,
    COUNT(*) OVER() AS total_count,
    e.first_name AS employee_first_name,
    e.last_name AS employee_last_name
FROM incident i
JOIN employee_profile e ON i.employee_id = e.id
WHERE i.client_id = $1
ORDER BY i.incident_date DESC
LIMIT $2 OFFSET $3
`

type ListIncidentsParams struct {
	ClientID int64 `json:"client_id"`
	Limit    int32 `json:"limit"`
	Offset   int32 `json:"offset"`
}

type ListIncidentsRow struct {
	ID                      int64              `json:"id"`
	EmployeeID              int64              `json:"employee_id"`
	LocationID              *int64             `json:"location_id"`
	ReporterInvolvement     string             `json:"reporter_involvement"`
	InformWho               []byte             `json:"inform_who"`
	IncidentDate            pgtype.Date        `json:"incident_date"`
	RuntimeIncident         string             `json:"runtime_incident"`
	IncidentType            string             `json:"incident_type"`
	PassingAway             bool               `json:"passing_away"`
	SelfHarm                bool               `json:"self_harm"`
	Violence                bool               `json:"violence"`
	FireWaterDamage         bool               `json:"fire_water_damage"`
	Accident                bool               `json:"accident"`
	ClientAbsence           bool               `json:"client_absence"`
	Medicines               bool               `json:"medicines"`
	Organization            bool               `json:"organization"`
	UseProhibitedSubstances bool               `json:"use_prohibited_substances"`
	OtherNotifications      bool               `json:"other_notifications"`
	SeverityOfIncident      string             `json:"severity_of_incident"`
	IncidentExplanation     *string            `json:"incident_explanation"`
	RecurrenceRisk          string             `json:"recurrence_risk"`
	IncidentPreventSteps    *string            `json:"incident_prevent_steps"`
	IncidentTakenMeasures   *string            `json:"incident_taken_measures"`
	Technical               []byte             `json:"technical"`
	Organizational          []byte             `json:"organizational"`
	MeseWorker              []byte             `json:"mese_worker"`
	ClientOptions           []byte             `json:"client_options"`
	OtherCause              *string            `json:"other_cause"`
	CauseExplanation        *string            `json:"cause_explanation"`
	PhysicalInjury          string             `json:"physical_injury"`
	PhysicalInjuryDesc      *string            `json:"physical_injury_desc"`
	PsychologicalDamage     string             `json:"psychological_damage"`
	PsychologicalDamageDesc *string            `json:"psychological_damage_desc"`
	NeededConsultation      string             `json:"needed_consultation"`
	Succession              []byte             `json:"succession"`
	SuccessionDesc          *string            `json:"succession_desc"`
	Other                   bool               `json:"other"`
	OtherDesc               *string            `json:"other_desc"`
	AdditionalAppointments  *string            `json:"additional_appointments"`
	EmployeeAbsenteeism     []byte             `json:"employee_absenteeism"`
	ClientID                int64              `json:"client_id"`
	SoftDelete              bool               `json:"soft_delete"`
	UpdatedAt               pgtype.Timestamptz `json:"updated_at"`
	CreatedAt               pgtype.Timestamptz `json:"created_at"`
	TotalCount              int64              `json:"total_count"`
	EmployeeFirstName       string             `json:"employee_first_name"`
	EmployeeLastName        string             `json:"employee_last_name"`
}

func (q *Queries) ListIncidents(ctx context.Context, arg ListIncidentsParams) ([]ListIncidentsRow, error) {
	rows, err := q.db.Query(ctx, listIncidents, arg.ClientID, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListIncidentsRow
	for rows.Next() {
		var i ListIncidentsRow
		if err := rows.Scan(
			&i.ID,
			&i.EmployeeID,
			&i.LocationID,
			&i.ReporterInvolvement,
			&i.InformWho,
			&i.IncidentDate,
			&i.RuntimeIncident,
			&i.IncidentType,
			&i.PassingAway,
			&i.SelfHarm,
			&i.Violence,
			&i.FireWaterDamage,
			&i.Accident,
			&i.ClientAbsence,
			&i.Medicines,
			&i.Organization,
			&i.UseProhibitedSubstances,
			&i.OtherNotifications,
			&i.SeverityOfIncident,
			&i.IncidentExplanation,
			&i.RecurrenceRisk,
			&i.IncidentPreventSteps,
			&i.IncidentTakenMeasures,
			&i.Technical,
			&i.Organizational,
			&i.MeseWorker,
			&i.ClientOptions,
			&i.OtherCause,
			&i.CauseExplanation,
			&i.PhysicalInjury,
			&i.PhysicalInjuryDesc,
			&i.PsychologicalDamage,
			&i.PsychologicalDamageDesc,
			&i.NeededConsultation,
			&i.Succession,
			&i.SuccessionDesc,
			&i.Other,
			&i.OtherDesc,
			&i.AdditionalAppointments,
			&i.EmployeeAbsenteeism,
			&i.ClientID,
			&i.SoftDelete,
			&i.UpdatedAt,
			&i.CreatedAt,
			&i.TotalCount,
			&i.EmployeeFirstName,
			&i.EmployeeLastName,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
